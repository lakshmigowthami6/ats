<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Career Boost - Resume Readiness AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap');
        
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #f9fafb;
            color: #374151;
        }

        .card-shadow {
            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            border: 1px solid #e5e7eb;
        }

        .primary-gradient {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
        }

        .score-circle { 
            transition: stroke-dashoffset 1.5s ease-in-out; 
        }

        .step-card {
            transition: transform 0.2s ease;
        }

        .step-card:hover {
            transform: translateY(-2px);
        }

        @keyframes pulse-soft {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .analyzing-text {
            animation: pulse-soft 2s infinite;
        }
    </style>
</head>
<body class="min-h-screen">

    <!-- Header -->
    <header class="bg-white border-b border-gray-200 py-4 px-6 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto flex justify-between items-center">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 primary-gradient rounded-lg flex items-center justify-center text-white">
                    <i class="fas fa-briefcase text-sm"></i>
                </div>
                <div>
                    <h1 class="text-lg font-bold text-gray-900 leading-tight">ATS Resume Analyzer</h1>
                    <p class="text-xs text-blue-600 font-semibold tracking-wide uppercase">Career Boost Engine</p>
                </div>
            </div>
            <div class="hidden md:flex items-center gap-6">
                <span class="text-sm font-medium text-gray-500 hover:text-blue-600 cursor-pointer">How it works</span>
                <span class="text-sm font-medium text-gray-500 hover:text-blue-600 cursor-pointer">Privacy</span>
                <div class="h-4 w-px bg-gray-200"></div>
                <span class="text-xs font-bold text-gray-400">FREE ACCESS</span>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-6 py-10">
        
        <!-- Welcome Section -->
        <div id="welcomeHeader" class="text-center mb-12">
            <h2 class="text-3xl font-extrabold text-gray-900 mb-3">Improve Your Job Readiness</h2>
            <p class="text-gray-500 max-w-xl mx-auto text-lg font-medium">Upload your resume and the job description to see how well you match the role and get tips to improve.</p>
        </div>

        <!-- Input Section -->
        <div id="inputSection" class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-10">
            <!-- Resume Upload -->
            <div class="bg-white rounded-2xl p-8 card-shadow flex flex-col">
                <div class="flex items-center gap-3 mb-6">
                    <i class="fas fa-file-pdf text-blue-500 text-xl"></i>
                    <h3 class="font-bold text-gray-800">Your Resume</h3>
                </div>
                
                <div id="dropZone" class="flex-1 border-2 border-dashed border-gray-200 rounded-xl p-10 text-center flex flex-col items-center justify-center bg-gray-50 hover:border-blue-300 hover:bg-blue-50/30 transition-all cursor-pointer group">
                    <input type="file" id="fileInput" class="hidden" accept=".pdf">
                    <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center shadow-sm mb-4 group-hover:scale-110 transition-transform">
                        <i class="fas fa-upload text-blue-500"></i>
                    </div>
                    <p class="text-sm font-bold text-gray-700">Click to upload or drag & drop</p>
                    <p class="text-xs text-gray-400 mt-1 uppercase font-semibold">PDF format required</p>
                    
                    <div id="fileName" class="mt-4 px-4 py-2 bg-white border border-green-100 rounded-lg text-green-600 text-xs font-bold hidden flex items-center gap-2">
                        <i class="fas fa-check-circle"></i> <span>RESUME.PDF</span>
                    </div>
                </div>
            </div>

            <!-- Job Description -->
            <div class="bg-white rounded-2xl p-8 card-shadow flex flex-col">
                <div class="flex items-center gap-3 mb-6">
                    <i class="fas fa-align-left text-blue-500 text-xl"></i>
                    <h3 class="font-bold text-gray-800">Job Description</h3>
                </div>
                <textarea id="jobDescInput" class="w-full flex-1 p-4 rounded-xl border border-gray-200 bg-gray-50 outline-none text-sm text-gray-600 focus:bg-white focus:border-blue-500 transition-all min-h-[200px] resize-none" placeholder="Paste the full job description here..."></textarea>
            </div>
        </div>

        <!-- Action Button -->
        <div id="actionArea" class="flex justify-center mb-16">
            <button id="analyzeBtn" class="primary-gradient text-white px-12 py-4 rounded-xl font-bold text-lg shadow-lg shadow-blue-200 flex items-center gap-3 hover:scale-[1.02] transition-transform">
                <i class="fas fa-wand-magic-sparkles"></i>
                Analyze My Resume
            </button>
        </div>

        <!-- Loading State -->
        <div id="loadingView" class="hidden py-20 text-center">
            <div class="inline-block w-12 h-12 border-4 border-blue-100 border-t-blue-600 rounded-full animate-spin mb-6"></div>
            <h3 class="text-xl font-bold text-gray-900 analyzing-text">Our AI is analyzing your readiness...</h3>
            <p class="text-gray-500 text-sm mt-2">Checking keywords, experience, and required skills.</p>
        </div>

        <!-- Results Dashboard -->
        <div id="resultsView" class="hidden space-y-8 animate-pro">
            
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Score Card -->
                <div class="bg-white rounded-2xl p-10 card-shadow flex flex-col items-center justify-center text-center">
                    <h4 class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-6">Job Readiness Score</h4>
                    <div class="relative flex items-center justify-center mb-6">
                        <svg class="w-44 h-44 transform -rotate-90">
                            <circle cx="88" cy="88" r="78" stroke="#f3f4f6" stroke-width="12" fill="transparent"></circle>
                            <circle id="scoreCircle" cx="88" cy="88" r="78" stroke="#3b82f6" stroke-width="12" fill="transparent" stroke-dasharray="490" stroke-dashoffset="490" stroke-linecap="round" class="score-circle"></circle>
                        </svg>
                        <div class="absolute flex flex-col items-center">
                            <span id="scoreVal" class="text-5xl font-extrabold text-gray-900">0%</span>
                        </div>
                    </div>
                    <div id="statusIndicator" class="px-6 py-2 rounded-full text-sm font-bold bg-blue-50 text-blue-600">
                        Analyzing Fit
                    </div>
                </div>

                <!-- Analysis Details -->
                <div class="lg:col-span-2 space-y-6">
                    <!-- Keyword Progress -->
                    <div class="bg-white rounded-2xl p-8 card-shadow">
                        <h4 class="font-bold text-gray-800 mb-6 flex items-center justify-between">
                            <span>Keyword Match Progress</span>
                            <span class="text-xs text-blue-600 font-bold" id="keywordPercent">0% matched</span>
                        </h4>
                        <div class="w-full bg-gray-100 h-3 rounded-full overflow-hidden">
                            <div id="progressBar" class="h-full primary-gradient transition-all duration-1000" style="width: 0%"></div>
                        </div>
                        <div class="grid grid-cols-2 gap-4 mt-6">
                            <div class="p-4 bg-green-50 rounded-xl border border-green-100">
                                <p class="text-[10px] uppercase font-bold text-green-600 mb-1">Found Skills</p>
                                <div id="matchedSkills" class="flex flex-wrap gap-2">
                                    <span class="text-xs font-semibold text-gray-600">Syncing...</span>
                                </div>
                            </div>
                            <div class="p-4 bg-orange-50 rounded-xl border border-orange-100">
                                <p class="text-[10px] uppercase font-bold text-orange-600 mb-1">Missing Keywords</p>
                                <div id="missingSkills" class="flex flex-wrap gap-2">
                                    <span class="text-xs font-semibold text-gray-600">Searching...</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Checklist -->
                    <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div class="bg-white p-4 rounded-xl card-shadow flex flex-col items-center text-center">
                            <i id="checkExp" class="fas fa-circle-check text-gray-200 mb-2"></i>
                            <span class="text-[10px] font-bold text-gray-500 uppercase">Experience</span>
                        </div>
                        <div class="bg-white p-4 rounded-xl card-shadow flex flex-col items-center text-center">
                            <i id="checkSkills" class="fas fa-circle-check text-gray-200 mb-2"></i>
                            <span class="text-[10px] font-bold text-gray-500 uppercase">Skills</span>
                        </div>
                        <div class="bg-white p-4 rounded-xl card-shadow flex flex-col items-center text-center">
                            <i id="checkEdu" class="fas fa-circle-check text-gray-200 mb-2"></i>
                            <span class="text-[10px] font-bold text-gray-500 uppercase">Education</span>
                        </div>
                        <div class="bg-white p-4 rounded-xl card-shadow flex flex-col items-center text-center">
                            <i id="checkProjects" class="fas fa-circle-check text-gray-200 mb-2"></i>
                            <span class="text-[10px] font-bold text-gray-500 uppercase">Projects</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Improvement Panel -->
            <div class="bg-white rounded-2xl p-8 card-shadow">
                <div class="flex items-center gap-3 mb-6 border-b border-gray-100 pb-4">
                    <i class="fas fa-list-check text-blue-500"></i>
                    <h3 class="font-bold text-gray-800">Next Steps to Improve</h3>
                </div>
                <div id="improvementContent" class="text-gray-600 text-sm leading-relaxed whitespace-pre-wrap">
                    <!-- AI Content -->
                </div>
            </div>

            <!-- Final Actions -->
            <div class="flex flex-col md:flex-row items-center justify-center gap-4 pt-10">
                <button onclick="location.reload()" class="w-full md:w-auto px-10 py-3 bg-white border border-gray-200 text-gray-600 rounded-xl font-bold text-sm hover:bg-gray-50 transition-colors">
                    Try Another Job
                </button>
                <button class="w-full md:w-auto px-10 py-3 primary-gradient text-white rounded-xl font-bold text-sm shadow-md">
                    Optimize My Resume
                </button>
            </div>
        </div>

    </main>

    <footer class="text-center py-10 text-gray-400 text-xs font-medium">
        Powered by AI for Freshers & Students | Secure & Private
    </footer>

    <script>
        const fileInput = document.getElementById('fileInput');
        const fileNameDisplay = document.getElementById('fileName');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const dropZone = document.getElementById('dropZone');

        // File Selection Logic
        dropZone.onclick = () => fileInput.click();
        fileInput.onchange = (e) => {
            if (e.target.files.length > 0) {
                fileNameDisplay.querySelector('span').innerText = e.target.files[0].name.toUpperCase();
                fileNameDisplay.classList.remove('hidden');
            }
        };

        // Analysis Logic
        analyzeBtn.onclick = async () => {
            const file = fileInput.files[0];
            const jd = document.getElementById('jobDescInput').value.trim();

            if (!file || !jd) {
                alert("Please upload your resume and paste a job description.");
                return;
            }

            // UI Transitions
            document.getElementById('welcomeHeader').classList.add('hidden');
            document.getElementById('inputSection').classList.add('hidden');
            document.getElementById('actionArea').classList.add('hidden');
            document.getElementById('loadingView').classList.remove('hidden');

            const formData = new FormData();
            formData.append('resume', file);
            formData.append('job_description', jd);

            try {
                const response = await fetch('/analyze', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    const err = await response.json().catch(() => null);
                    throw new Error(err?.error || 'Network error');
                }

                const data = await response.json();
                renderResults(data);
            } catch (error) {
                console.error(error);
                alert("Could not connect to the analyzer. Make sure the backend is running.");
                location.reload();
            }
        };

        function renderResults(data) {
            document.getElementById('loadingView').classList.add('hidden');
            document.getElementById('resultsView').classList.remove('hidden');

            const text = data.ats_result;
            
            // Extract Score
            const scoreMatch = text.match(/(\d+)%/);
            const score = scoreMatch ? parseInt(scoreMatch[1]) : 65;

            // Animate Score
            const circle = document.getElementById('scoreCircle');
            const circumference = 490;
            const offset = circumference - (circumference * score) / 100;
            
            setTimeout(() => {
                circle.style.strokeDashoffset = offset;
                document.getElementById('progressBar').style.width = score + '%';
                document.getElementById('keywordPercent').innerText = score + '% matched';
                
                let start = 0;
                const duration = 1500;
                const startTime = performance.now();
                function update(now) {
                    const elapsed = now - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    document.getElementById('scoreVal').innerText = Math.floor(progress * score) + '%';
                    if (progress < 1) requestAnimationFrame(update);
                }
                requestAnimationFrame(update);
            }, 100);

            // Update Status Indicator
            const indicator = document.getElementById('statusIndicator');
            if(score >= 80) {
                indicator.innerText = "READY FOR APPLYING";
                indicator.classList.add('bg-green-50', 'text-green-600');
                circle.setAttribute('stroke', '#10b981');
            } else if(score >= 50) {
                indicator.innerText = "IMPROVING";
                indicator.classList.add('bg-blue-50', 'text-blue-600');
            } else {
                indicator.innerText = "NEEDS WORK";
                indicator.classList.add('bg-orange-50', 'text-orange-600');
                circle.setAttribute('stroke', '#f97316');
            }

            // Fill Suggestion Panel
            document.getElementById('improvementContent').innerText = text;

            // Mock Data for Skills (since current LLM returns string)
            // In a real app, you'd parse keywords into these arrays
            const skillsMock = data.parsed_job_description.split('\n').slice(0, 4).map(s => s.replace(/[^a-zA-Z]/g, ''));
            document.getElementById('matchedSkills').innerHTML = skillsMock.slice(0, 2).map(s => `<span class="px-2 py-1 bg-green-100 text-green-700 rounded-md font-bold text-[10px]">${s}</span>`).join('');
            document.getElementById('missingSkills').innerHTML = skillsMock.slice(2, 4).map(s => `<span class="px-2 py-1 bg-orange-100 text-orange-700 rounded-md font-bold text-[10px]">${s}</span>`).join('');

            // Highlight checklist icons
            if(score > 30) document.getElementById('checkEdu').classList.replace('text-gray-200', 'text-blue-500');
            if(score > 50) document.getElementById('checkSkills').classList.replace('text-gray-200', 'text-blue-500');
            if(score > 70) document.getElementById('checkExp').classList.replace('text-gray-200', 'text-blue-500');
            if(score > 80) document.getElementById('checkProjects').classList.replace('text-gray-200', 'text-blue-500');
        }
    </script>
</body>
</html>
